<mat-toolbar>

  <div>
    <button mat-button [matMenuTriggerFor]="menu"><mat-icon>expand_more</mat-icon> نوع سند القيد
    </button>
    <mat-menu #menu="matMenu">
        <button mat-menu-item (click)="save()">حفظ نظامي</button>
        <button mat-menu-item (click)="save_as_draft()">مسوده</button>
    </mat-menu>
</div>


  <!-- <button class="add" mat-raised-button class="add" (click)="attachments()">مرفقات F3</button> -->
  <!-- <button class="add" mat-raised-button class="add" (click)="accountCard()">بطاقة حساب</button> -->
  <!-- <button class="add" mat-raised-button class="add" (click)="toExcel()">الى اكسل</button>
    <button class="add" mat-raised-button class="add" (click)="search()">بحث عن</button>
    <button class="add" mat-raised-button class="add" (click)="fromExcel()">من اكسل</button>
    <button class="add" mat-raised-button class="add" (click)="conflict()">تعارض</button> -->
</mat-toolbar>
<form [formGroup]="Form">
  <span>معلومات السند</span>
  <div class="up">
    <div class="right">
      <div class="inputGroup1" style="display: flex; flex-direction: column;">

        <div class="date">
          <span class="white" style="margin-bottom: 10px; display: block;">تاريخ السند</span>
          <div class="content">
            <mat-form-field class="example-full-width small-width" appearance="fill">
              <mat-label>اليوم</mat-label>
              <input matInput placeholder="ex: 21" (change)="sanadDateChange('day')" [(ngModel)]='sanadDateDay'
                [ngModelOptions]="{standalone: true}" id="sanadDateDay" (keyup.enter)="focusNext('QararDateMonth')">
            </mat-form-field>
            <mat-form-field class="example-full-width small-width" appearance="fill">
              <mat-label>الشهر</mat-label>
              <input matInput placeholder="ex: 1" (change)="sanadDateChange('month')" [(ngModel)]='sanadDateMonth'
                [ngModelOptions]="{standalone: true}" id="sanadDateMonth" (keyup.enter)="focusNext('QararDateYear')">
            </mat-form-field>
            <mat-form-field class="example-full-width small-width" appearance="fill">
              <mat-label>العام</mat-label>
              <input matInput placeholder="ex: 2023" (change)="sanadDateChange('year')" [(ngModel)]='sanadDateYear'
                [ngModelOptions]="{standalone: true}" id="sanadDateYear" (keyup.enter)="focusNext('QararDateDay')">
            </mat-form-field>
          </div>
        </div>

        <div class="date">
          <span class="white" style="margin-bottom: 10px; display: block;">تاريخ المذكرة</span>
          <div class="content">
            <mat-form-field class="example-full-width small-width" appearance="fill">
              <mat-label>اليوم</mat-label>
              <input matInput placeholder="ex: 21" (change)="incumbentDateChange('day')" [(ngModel)]='incumbentDateDay'
                [ngModelOptions]="{standalone: true}" id="incumbentDateDay" (keyup.enter)="focusNext('QararDateMonth')">
            </mat-form-field>
            <mat-form-field class="example-full-width small-width" appearance="fill">
              <mat-label>الشهر</mat-label>
              <input matInput placeholder="ex: 1" (change)="incumbentDateChange('month')"
                [(ngModel)]='incumbentDateMonth' [ngModelOptions]="{standalone: true}" id="incumbentDateMonth"
                (keyup.enter)="focusNext('QararDateYear')">
            </mat-form-field>
            <mat-form-field class="example-full-width small-width" appearance="fill">
              <mat-label>العام</mat-label>
              <input matInput placeholder="ex: 2023" (change)="incumbentDateChange('year')"
                [(ngModel)]='incumbentDateYear' [ngModelOptions]="{standalone: true}" id="incumbentDateYear"
                (keyup.enter)="focusNext('QararDateDay')">
            </mat-form-field>
          </div>
        </div>
      </div>

      <div class="inputGroup3" style="display: flex; justify-content: space-between; width: 435px;">
        <mat-form-field class="fitContent" appearance="fill" style="height: fit-content;">
          <mat-label>رقم المذكرة</mat-label>
          <input matInput [OnlyNumber]="true" [formControl]="incumbent_id" id="incumbent_id" (keyup.enter)="focusNext('account_type')">
        </mat-form-field>

        <mat-form-field class="fitContent" appearance="fill" style="height: fit-content;">
          <mat-label>رقم السند</mat-label>
          <input matInput [OnlyNumber]="true" [formControl]="document_id" id="document_id" (keyup.enter)="focusNext('account_type')">
        </mat-form-field>
      </div>


      <div>
        <mat-form-field class="fitContent" appearance="fill">
          <mat-label>دفتر السندات</mat-label>
          <input matInput [formControl]="book_fk" [matAutocomplete]="auto_book_fk" id="Book_fk"
            (keyup.enter)="focusNext('phone')">
          <mat-autocomplete #auto_book_fk="matAutocomplete" (optionSelected)="select_Book_Option($event)"
            [displayWith]="displayBookProperty.bind(this)">
            <mat-option *ngFor="let option of filter_List_sanad_kid_book | async" [value]="option.sanad_kid_book_seq">
              {{option.sanad_kid_book_name}}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>
      </div>

      <div class="inputGroup5" style="display: flex; flex-direction: column;">




        <mat-form-field class="fitContent" appearance="fill" style="margin-top: 30px;">
          <mat-label>اسم صاحب الاستحقاق</mat-label>
          <input matInput [formControl]="name_of_owner" id="name_of_owner" (keyup.enter)="focusNext('account_type')">
        </mat-form-field>

 
      </div>

    </div>


  </div>


</form>

<div class="down" style="display: flex; justify-content: space-between; flex-wrap: wrap;">
  <div class="donwLeft">
    <span>المرفقات</span>
    <div class="detail" *ngFor="let attachment of exchange_order.exchange_order_attachements; let i=index;">
      <app-exchange-order-attachments [index]="i"
        (onDelete)="onAttachmentDelete($event)"></app-exchange-order-attachments>
    </div>
    <button class="add" mat-raised-button class="add" (click)="addAttachment()">إضافة مرفق+</button>



  </div>
  <div class="donwmiddle">
    <table mat-table [dataSource]="dataSource_exchange_order_entry" class="mat-elevation-z8" matSort>

      <ng-container matColumnDef="ex_ord_stg_name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>المرحلة </th>
        <td mat-cell *matCellDef="let element">{{element?.exchange_order_stage.ex_ord_stg_name}}</td>
      </ng-container>

      <ng-container matColumnDef="user_entry">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>المستخدم </th>
        <td mat-cell *matCellDef="let element">{{element?.user_entry.user_first_name}}
          {{element?.user_entry.user_last_name}}</td>
      </ng-container>

      <ng-container matColumnDef="date_entry">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>تاريخ الحفظ </th>
        <td mat-cell *matCellDef="let element">{{element?.date_entry | date:'yyyy/MM/dd'}}</td>
      </ng-container>


      <tr mat-header-row *matHeaderRowDef="exchange_order_entry_displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: exchange_order_entry_displayedColumns;let idx=index;"
        [style.background-color]="rowClicked == idx ? 'yellow': 'none'" (click)="changeTableRowColor(idx)"></tr>
    </table>

    <mat-paginator #paginator [length]="totalRows" [pageIndex]="currentPage" [pageSize]="pageSize"
      [pageSizeOptions]="pageSizeOptions" showFirstLastButtons></mat-paginator>
  </div>


</div>

<div class="down">
  <span>تفاصيل أمر الصرف</span>
  <div class="detail" *ngFor="let details of exchange_order.exchange_order_details; let i=index;">
    <app-exchange-order-detail [index]="i" (onDelete)="onDetailsDelete($event)"></app-exchange-order-detail>
  </div>
  <button class="add" mat-raised-button class="add" (click)="addDetails()">إضافة تفصيل+</button>
</div>
<!-- </ngx-hover-opacity> -->